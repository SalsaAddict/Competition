var comp=angular.module("Competition",["ui.bootstrap"]),Competition;(function(n){"use strict";var t=function(){function n(n,t){this.$filter=n;this.$log=t;this.judges=["Alex","Biskit","Pierre"];this.competitors=[{id:2,name:"Ylenio",results:[1,1,2]},{id:1,name:"Sergio",results:[2,3,1]},{id:4,name:"Fenix",results:[3,2,3]},{id:5,name:"Raj",results:[4,4,5]},{id:3,name:"Vaibhav",results:[5,5,4]}]}return Object.defineProperty(n.prototype,"competitorsById",{get:function(){return this.$filter("orderBy")(this.competitors,"id")},enumerable:!0,configurable:!0}),n.prototype.judgeResults=function(n){var i=this.judges.indexOf(n),t=[];return this.competitorsById.forEach(function(n){t.push(n.results[i]||null)}),t},n.prototype.isValidResult=function(n,t){var i=n[t]||null;return i===null?!1:i<1?!1:i>this.competitors.length?!1:n.indexOf(i,t+1)>-1?!1:!0},n.prototype.isValidJudge=function(n){for(var i=!0,r=this.judgeResults(n),t=0;t<r.length;t++)if(!this.isValidResult(r,t)){i=!1;break}return i},n.prototype.isValidCompetitor=function(n){for(var i=!0,t=0;t<this.judges.length;t++)if(!this.isValidResult(this.judgeResults(this.judges[t]),n)){i=!1;break}return i},n.prototype.isValid=function(){for(var t=!0,n=0;n<this.judges.length;n++)if(!this.isValidJudge(this.judges[n])){t=!1;break}return t},Object.defineProperty(n.prototype,"majority",{get:function(){return Math.ceil(this.judges.length/2)},enumerable:!0,configurable:!0}),n.prototype.majorityCount=function(n,t){for(var r=0,i=0;i<n.results.length;i++)n.results[i]<=t&&r++;return r},n.prototype.simpleMajority=function(n){var t=this,i=[];return this.competitors.forEach(function(r){angular.isDefined(r.rank)||t.majorityCount(r,n)>=t.majority&&i.push(r)}),i},n.prototype.assignRank=function(n){this.$log.debug("assignRank",n);var t=this.simpleMajority(n);if(this.$log.debug("simpleMajority",n,t.length,t),t.length===1){t[0].rank=n;return}},n.prototype.calculate=function(){this.assignRank(1);this.assignRank(2);this.assignRank(3);this.assignRank(4);this.assignRank(5)},n.prototype.$postLink=function(){},n.$inject=["$filter","$log"],n}(),i;n.Controller=t,function(n){function i(){return function(){return{restrict:"A",controller:t,bindToController:{max:"=rankInput"},require:{ngModel:"^ngModel"}}}}var t=function(){function n(){}return n.prototype.$postLink=function(){var n=this;this.ngModel.$parsers.unshift(function(n){return parseInt(n,10)});this.ngModel.$validators.min=function(n){return n>=1};this.ngModel.$validators.max=function(t){return t<=n.max}},n}();n.Controller=t;n.DirectiveFactory=i}(i=n.RankInput||(n.RankInput={}))})(Competition||(Competition={}));comp.controller("competitionController",Competition.Controller);comp.directive("rankInput",Competition.RankInput.DirectiveFactory());