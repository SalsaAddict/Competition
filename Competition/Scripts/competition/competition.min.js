var comp=angular.module("Competition",["ui.bootstrap"]),Competition;(function(n){"use strict";var t=function(){function n(n,t){this.$filter=n;this.$log=t;this.judges=["Alex","Biskit","Pierre"];this.competitors=[{id:2,name:"Ylenio",results:[1,1,2]},{id:1,name:"Sergio",results:[2,3,1]},{id:4,name:"Fenix",results:[3,2,3]},{id:5,name:"Raj",results:[4,4,5]},{id:3,name:"Vaibhav",results:[5,5,4]}]}return Object.defineProperty(n.prototype,"competitorsById",{get:function(){return this.$filter("orderBy")(this.competitors,"id")},enumerable:!0,configurable:!0}),n.prototype.judgeResults=function(n){var i=this.judges.indexOf(n),t=[];return this.competitorsById.forEach(function(n){t.push(n.results[i]||null)}),t},n.prototype.isValidResult=function(n,t){var i=n[t]||null;return i===null?!1:i<1?!1:i>this.competitors.length?!1:n.indexOf(i,t+1)>-1?!1:!0},n.prototype.isValidJudge=function(n){for(var i=!0,r=this.judgeResults(n),t=0;t<r.length;t++)if(!this.isValidResult(r,t)){i=!1;break}return i},n.prototype.isValidCompetitor=function(n){for(var i=!0,t=0;t<this.judges.length;t++)if(!this.isValidResult(this.judgeResults(this.judges[t]),n)){i=!1;break}return i},n.prototype.isValid=function(){for(var t=!0,n=0;n<this.judges.length;n++)if(!this.isValidJudge(this.judges[n])){t=!1;break}return t},n.prototype.tally=function(){var n=this;this.competitors.forEach(function(t){var r,i;for(t.tally=[],r=function(i){var r={majority:!1,count:0,sum:0};t.results.forEach(function(n){n<=i+1&&(r.count++,r.sum+=n)});r.count>n.majority&&(r.majority=!0);t.tally.push(r)},i=0;i<n.competitors.length;i++)r(i)})},n.prototype.ranked=function(){var n=this;return this.$filter("orderBy")(this.competitors,function(){for(var i=function(n){var t=function(t){return t.tally[n]}},t=0;t<n.competitors.length;t++)i(t);return[]})},Object.defineProperty(n.prototype,"majority",{get:function(){return Math.ceil(this.judges.length/2)},enumerable:!0,configurable:!0}),n.prototype.calculate=function(){this.tally();this.ranked().forEach(function(n,t){n.rank=t+1})},n.prototype.$postLink=function(){},n.$inject=["$filter","$log"],n}(),i;n.Controller=t,function(n){function i(){return function(){return{restrict:"A",controller:t,bindToController:{max:"=rankInput"},require:{ngModel:"^ngModel"}}}}var t=function(){function n(){}return n.prototype.$postLink=function(){var n=this;this.ngModel.$parsers.unshift(function(n){return parseInt(n,10)});this.ngModel.$validators.min=function(n){return n>=1};this.ngModel.$validators.max=function(t){return t<=n.max}},n}();n.Controller=t;n.DirectiveFactory=i}(i=n.RankInput||(n.RankInput={}))})(Competition||(Competition={}));comp.controller("competitionController",Competition.Controller);comp.directive("rankInput",Competition.RankInput.DirectiveFactory());